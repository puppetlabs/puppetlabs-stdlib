require 'spec_helper'

cert = <<-'DOC'
-----BEGIN CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUWD+PtJcPByLOK0dO2CTzROkCF6AwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMjA2MDMxMjUyNDJaFw0yMzA2
MDMxMjUyNDJaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQDKlr+aNnD1wvq6Hge4KhLRA6d+a1jkY6XkaT56iU1R
HUzbJpw75A7YVs6cag7UylXcAVSGhw0z2PBlHwEhGmL5KnDYmeeWWNeDmoY/3fno
9UzIiY8lh68/v8gTliqvfZ+0Eu9ewA9kOH9/13T9ELwSKLCbBa6qM73PB3LxiMpN
6L35TxZTYqmw8H3MGvbKghoh301Wv+TmZw9scJKmYvecFgKzc8VoTha/tf79IsNf
9X35othfmMLganDWe8TN+SKO7iBSXmPLSVGYVyQNqZ5cl2dDerTz+6OvCsno8V35
8y2OPDPb9d14O36FhWJ7ODYaM76HQogbvGpccwuEZv8lAgMBAAGjUzBRMB0GA1Ud
DgQWBBRq/POrmFJ64R8rs/cXAjrSPz0r3DAfBgNVHSMEGDAWgBRq/POrmFJ64R8r
s/cXAjrSPz0r3DAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBn
qq55aMGo9hM4p1HCsCWlBhr3uVzu/VVb6YEae3oqLu7a+UovO9QCahlC8bCxSN1g
ciL6JwoACEAH0nCyeuiAQ8XoVnl9gVge952M3zZbJ/T/DVR61abrsCzQAS4PDikE
gPwMrK5uT9pwep67V5MwZhOQ51U6n6rZUOJlwM1zTwoMbBIX8i9yR2BddFpcd3+8
sf7PF+gSSsaMyDS8RYdJPa/o9DHi5NdUtvAFE+V8AzJv55l6c3rAw/A5BdWzHDCZ
T0/olVZcQyGsXblqdBFAh8BYXOOuLMDp4jXAoC8dNsImakCKuoI+zVxz4ob36p1e
6xgFDRqCma9S8v8c1QHX
-----END CERTIFICATE-----
DOC

pkey = <<-'DOC'
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAypa/mjZw9cL6uh4HuCoS
0QOnfmtY5GOl5Gk+eolNUR1M2yacO+QO2FbOnGoO1MpV3AFUhocNM9jwZR8BIRpi
+Spw2JnnlljXg5qGP9356PVMyImPJYevP7/IE5Yqr32ftBLvXsAPZDh/f9d0/RC8
EiiwmwWuqjO9zwdy8YjKTei9+U8WU2KpsPB9zBr2yoIaId9NVr/k5mcPbHCSpmL3
nBYCs3PFaE4Wv7X+/SLDX/V9+aLYX5jC4Gpw1nvEzfkiju4gUl5jy0lRmFckDame
XJdnQ3q08/ujrwrJ6PFd+fMtjjwz2/XdeDt+hYViezg2GjO+h0KIG7xqXHMLhGb/
JQIDAQAB
-----END PUBLIC KEY-----
DOC

describe 'stdlib::ssl::extract_pkey' do
  context 'Valid test' do
    it "run test #{name}" do
      is_expected.to run.with_params(cert).and_return(pkey)
    end
  end
end
