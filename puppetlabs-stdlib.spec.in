# special thanks to kkeithley for using his wizard rpm skills to get this going
%global puppet_module_version __VERSION__

Name:		puppetlabs-stdlib
Version:	__VERSION__
#Release:	__RELEASE__%{?dist}	# use this to make dist specific builds
Release:	__RELEASE__
Summary:	Puppetlabs standard library
License:	ASLv2+
URL:		https://github.com/purpleidea/puppetlabs-stdlib
Source0:	https://download.gluster.org/pub/gluster/purpleidea/puppetlabs-stdlib/SOURCES/puppetlabs-stdlib-%{puppet_module_version}.tar.bz2
BuildArch:	noarch

Requires: puppet >= 2.7.0

%description
Puppet Labs Standard Library module.

%prep
%setup -c -q -T -D -a 0

find %{_builddir} -type f -name ".*" -exec rm {} +
find %{_builddir} -size 0 -exec rm {} +
find %{_builddir} \( -name "*.pl" -o -name "*.sh"  \) -exec chmod +x {} +
find %{_builddir} \( -name "*.pp" -o -name "*.py"  \) -exec chmod -x {} +
find %{_builddir} \( -name "*.rb" -o -name "*.erb" \) -exec chmod -x {} + -exec sed -i "/^#!/{d;q}" {} +

%build

%install
rm -rf %{buildroot}
# _datadir is typically /usr/share/
install -d -m 0755 %{buildroot}/%{_datadir}/puppet/modules/
cp -r puppetlabs-stdlib-%{puppet_module_version} %{buildroot}/%{_datadir}/puppet/modules/stdlib

%files
%{_datadir}/puppet/modules/*

# this changelog is auto-generated by git log
%changelog
